sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)
sample.bwt.smoke <- sample(bwt.smoke,N)
bwt.test <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)
return (popdiff>bwt.test$conf.int[1] & popdiff$conf.int<bwt.test[2])
}
mean(replicate(1000, conf.diff()))
conf.diff<-function(){
sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)
sample.bwt.smoke <- sample(bwt.smoke,N)
bwt.test <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)
return (popdiff>bwt.test$conf.int[1] & popdiff<bwt.test$conf.int[2])
}
mean(replicate(1000, conf.diff()))
dat.ns = sample(bwt.nonsmoke, 30)
dat.s = sample(bwt.smoke, 30)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
tval = (X.ns - X.s)/sd.diff
(X.ns - X.s)
sd.diff
ci.upper = (X.ns-X.s) + sd.diff*1.96
ci.lower = (X.ns-X.s) - sd.diff*1.96
ci.upper
N=30
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
(X.ns-X.s)
(X.ns-X.s)/sd.diff
ci.upper = (X.ns-X.s) + sd.diff*1.96
ci.lower = (X.ns-X.s) - sd.diff*1.96
ci.upper
ci.lower
sd.diff
N=30
diff.mean<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff
}
mean(replicate(1000, diff.compare()))
N=30
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff
}
mean(replicate(1000, diff.compare()))
N=30
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff
}
replicate(1000, diff.compare())
sd.diff
(X.ns-X.s)
(X.ns-X.s)
N=30
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff
}
replicate(1000, diff.compare())
mean(replicate(1000, diff.compare()))
mean(replicate(1000, diff.compare()))
mean(replicate(1000, diff.compare()))
mean(replicate(1000, diff.compare()))
mean(replicate(1000, diff.compare()))
ci.upper = (X.ns-X.s) + sd.diff*1.96
ci.lower = (X.ns-X.s) - sd.diff*1.96
ci.lower
ci.upper
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
tval = (X.ns - X.s)/sd.diff
tval
qnorm(1-0.05/2)
ci.upper
ci.lower
t.test(dat.ns,dat.s)
tval
dat.ns = sample(bwt.nonsmoke, 30)
dat.s = sample(bwt.smoke, 30)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
tval = (X.ns - X.s)/sd.diff
t.test(dat.ns,dat.s)
tval
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff<0
}
sum(replicate(1000, diff.compare()))
N=30
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff<0
}
mean(replicate(1000, diff.compare()))
N=30
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff<0
}
mean(replicate(1000, diff.compare()))
N=30
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
(X.ns-X.s)/sd.diff<0
}
mean(replicate(1000, diff.compare()))
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
abs(X.ns-X.s/sd.diff)
}
mean(replicate(1000, diff.compare()))
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
abs(X.ns-X.s/sd.diff)
}
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
diff.compare()
diff.compare<-function(){
dat.ns <- sample(bwt.nonsmoke,N)
dat.s <- sample(bwt.smoke,N)
X.ns = mean(dat.ns)
sd.ns = sd(dat.ns)
X.s = mean(dat.s)
sd.s = sd(dat.s)
sd.diff = sqrt(sd.ns^2/30 + sd.s^2/30)
abs((X.ns-X.s)/sd.diff)
}
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
min(replicate(1000, diff.compare()))
reject <- function(N,alpha=0.05){
sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)
sample.bwt.smoke <- sample(bwt.smoke,N)
pval <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)$p.value
ifelse(pval < alpha,1,0)
}
rejections <- replicate(10000,reject(N))
rejections
mean(replicate(10000,reject(N)))
mean(replicate(10000,reject(N,0.01)))
mean(replicate(10000,reject(N,0.01)))
mean(replicate(10000,reject(N,0.05)))
babies = read.table("https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt", header=TRUE)
bwt.nonsmoke = babies$bwt[babies$smoke==0]
bwt.smoke = babies$bwt[babies$smoke==1]
N=30
reject <- function(N,alpha){
sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)
sample.bwt.smoke <- sample(bwt.smoke,N)
pval <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)$p.value
ifelse(pval < alpha,1,0)
}
mean(replicate(10000,reject(N,0.01)))
mean(replicate(10000,reject(N,0.05)))
mean(replicate(10000,reject(N,0.1)))
N=15
reject <- function(N,alpha){
sample.bwt.nonsmoke <- sample(bwt.nonsmoke,N)
sample.bwt.smoke <- sample(bwt.smoke,N)
pval <- t.test(sample.bwt.nonsmoke,sample.bwt.smoke)$p.value
ifelse(pval < alpha,1,0)
}
mean(replicate(10000,reject(N,0.1)))
mean(replicate(10000,reject(N,0.1)))
mean(replicate(10000,reject(N,0.05)))
mean(replicate(10000,reject(N,0.01)))
qnorm(.99)
qnorm(0.99)
dnorm(n.student)
rnorm(n.student)
n.student<-2000
rnorm(n.student)
norm.response <- rnorm(n.student)
norm.response < qnorm(0.99)
average(norm.response < qnorm(0.99))
mean(norm.response < qnorm(0.99))
sum(norm.response < qnorm(0.99))
sum(norm.response > qnorm(0.99))
n.student<-2000
norm.response <- rnorm(n.student)
sum(norm.response > qnorm(0.99))
n.student<-2000
norm.response <- rnorm(n.student)
sum(norm.response > qnorm(0.99))
d = read.csv("https://courses.edx.org/c4x/HarvardX/PH525.1x/asset/assoctest.csv")
head(d)
table(d)
rownamesa(d.table)
rownames(d.table)
d.table <- table(d)
rownames(d.table)
rownames(d.table)<-("AA/Aa","aa")
rownames(d.table)<-("AA/Aa","aa")
rownames(d.table)<-c("AA/Aa","aa")
d.table
colnames(d.table)
d.table
colnames(d.table) <- c("control","case")
d.table
chisq.test(d.table)$p.value
chisq.test(d.table)
test<-chisq.test(d.table)
test$statistic
chisq.test(d.table)$statistic
fisher.test(d.table,alternative="greater")
fisher.test(d.table,alternative="greater")$p-valu
t<-fisher.test(d.table,alternative="greater")
t$p.value
t<-fisher.test(d.table,alternative="greater")$p.value
fisher.test(d.table,alternative="greater")$p.value
fisher.test(d.table)$p.value
d = read.csv("https://courses.edx.org/c4x/HarvardX/PH525.1x/asset/assoctest.csv")
d.table <- table(d)
#rownames(d.table) <- c("AA/Aa","aa")
#colnames(d.table) <- c("control","case")
chisq.test(d.table)$statistic
fisher.test(d.table)$p.value
babies = read.table("https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt", header=TRUE)
bwt.nonsmoke = babies$bwt[babies$smoke==0]
bwt.smoke = babies$bwt[babies$smoke==1]
pop.var = var(bwt.nonsmoke)
pop.var
sample(bwt.nonsmoke,N)
N = 10
sample(bwt.nonsmoke,N)
var(sample(bwt.nonsmoke,N))
vars = replicate(1000, var(sample(bwt.nonsmoke,N)))
vars
pop.var
mean(vars > pop.var*1.5)
vars = replicate(1000, var(sample(bwt.nonsmoke,10)))
mean(vars > pop.var*1.5)
vars = replicate(1000, var(sample(bwt.nonsmoke,50)))
mean(vars > pop.var*1.5)
vars = replicate(1000, var(sample(bwt.nonsmoke,50)))
mean(vars > pop.var*1.5)
vars = replicate(1000, var(sample(bwt.nonsmoke,50)))
mean(vars > pop.var*1.5)
vars = replicate(1000, var(sample(bwt.nonsmoke,50)))
mean(vars > pop.var*1.5)
smokers <- sample(dat$bwt[dat$smoke==1],N)
smokers <- sample(babies$bwt[dat$smoke==1],N)
nonsmokers <- sample(babies$bwt[dat$smoke==0],N)
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
mean(abs(avgdiff) > abs(obs))
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
set.seed(0)
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
set.seed(0)
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
set.seed(0)
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
set.seed(0)
N=50
smokers <- sample(babies$bwt[babies$smoke==1],N)
nonsmokers <- sample(babies$bwt[babies$smoke==0],N)
obs <- mean(smokers)-mean(nonsmokers)
avgdiff <- replicate(1000, {
all <- sample(c(smokers,nonsmokers))
smokersstar <- all[1:N]
nonsmokersstar <- all[(N+1):(2*N)]
return(mean(smokersstar) - mean(nonsmokersstar))
})
mean(abs(avgdiff) > abs(obs))
